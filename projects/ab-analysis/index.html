<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Marketing A/B Analysis — Demo</title>
  <link rel="stylesheet" href="../../styles.css" />
  <style>.demo{max-width:760px;margin:1rem auto;padding:1rem;background:linear-gradient(#021018,#031622);border-radius:8px;color:var(--text)}</style>
</head>
<body>
  <header class="site-header"><div class="container header-inner"><a href="../../index.html">← Back</a><h1 class="brand">A/B Analysis (Demo)</h1></div></header>
  <main class="container">
    <section class="demo">
      <p>Compare two variants' conversion rates and see a simple z-test result.</p>
      <p><img src="screenshot.svg" alt="A/B demo screenshot" style="max-width:100%;border-radius:8px;border:1px solid rgba(255,255,255,0.03)"></p>
      <div>
        <label>Variant A: <input id="a_conv" type="number" value="120"> conversions</label>
        <label> <input id="a_n" type="number" value="2400"> visits</label>
      </div>
      <div>
        <label>Variant B: <input id="b_conv" type="number" value="150"> conversions</label>
        <label> <input id="b_n" type="number" value="2500"> visits</label>
      </div>
      <p style="margin-top:.5rem">Pooled z-test p-value: <strong id="pval">—</strong></p>
    </section>
  </main>
  <script>
    function ztest(x1,n1,x2,n2){
      const p1 = x1/n1; const p2 = x2/n2;
      const p = (x1+x2)/(n1+n2);
      const se = Math.sqrt(p*(1-p)*(1/n1 + 1/n2));
      const z = (p1-p2)/se;
      const pval = 2*(1-phi(Math.abs(z)));
      return pval;
    }
    // normal CDF via erf approximation
    function phi(z){return 0.5*(1+erf(z/Math.sqrt(2)));}
    function erf(x){ // numeric erf
      const sign = (x>=0)?1:-1; x = Math.abs(x);
      const a1=  0.254829592; const a2=-0.284496736; const a3= 1.421413741; const a4=-1.453152027; const a5= 1.061405429; const p=0.3275911;
      const t = 1/(1+p*x); const y = 1 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*Math.exp(-x*x);
      return sign*y;
    }
    const inputs = ['a_conv','a_n','b_conv','b_n'].map(id=>document.getElementById(id));
    function update(){
      const vals = inputs.map(i=>Number(i.value));
      const p = ztest(vals[0],vals[1],vals[2],vals[3]);
      document.getElementById('pval').textContent = p.toExponential(3);
    }
    inputs.forEach(i=>i.addEventListener('input', update)); update();
  </script>
</body>
</html>
